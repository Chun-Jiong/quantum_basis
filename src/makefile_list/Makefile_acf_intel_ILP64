CXX       = icpc
CPPFLAGS  = -O2 -std=c++11 -traceback -w3 -wd383,981 -DMKL_ILP64 -qopenmp \
            -isystem ${MKLROOT}/include \
            -isystem ${HOME}/opt/arpackpp/include -isystem ${HOME}/opt/arpackpp/examples/areig \
            -isystem /sw/acf/boost/1.64.0/centos7.3_binary/include
LIBS      = -L${HOME}/opt/ARPACK_ILP64 -larpack -lgfortran \
            -L${MKLROOT}/lib/intel64 -lmkl_intel_ilp64 -lmkl_intel_thread -lmkl_core -liomp5 -lpthread -lm -ldl \
            -qopenmp \
            -L /sw/acf/boost/1.64.0/centos7.3_binary/lib -lboost_filesystem -lboost_system

include makefile_list/object_list.txt

test: $(OBJS) test.o test_basis.o test_lanczos.o test_lattice.o test_operator.o
	$(CXX) $(OBJS) test.o test_basis.o test_lanczos.o test_lattice.o test_operator.o $(LIBS) -o ../bin/test.x

libqbasis.a: $(OBJS)
	ar rvs libqbasis.a $(OBJS)

install: libqbasis.a
	$(RM) ${HOME}/installs/lib/libqbasis.*; cp libqbasis.a ${HOME}/installs/lib; cp qbasis.h ${HOME}/installs/include

%.o: %.cc
	$(CXX) $(CPPFLAGS) -c -o $@ $<

clean:
	$(RM) *.o
